# 企業比較画面 設計書 (`/compare`)

## 1. 概要
ユーザーが選択した企業（最大4社）を比較し、数値データのヒートマップ表示によって「優良企業」を直感的に発見できる画面。

### 主な目的
- 複数企業の定量データ（年収、労働環境、財務）を一目で比較する
- 業界平均や他社と比較して「良い」「悪い」を色で識別する
- ユーザーの意思決定（応募する/しない）を支援する

---

## 2. 画面レイアウト構成

### 2.1 ヘッダー領域 (Sticky)
スクロールしても常に上部に固定表示され、どの企業のデータを見ているか迷わないようにする。

- **表示項目**:
  - 企業ロゴ（なければ社名の頭文字アイコン）
  - 企業名（省略なし、または2行表示）
  - 「削除」ボタン（×アイコン）

### 2.2 データ比較テーブル
カテゴリごとに整理されたリスト形式。
スマホでは横スクロールが発生する場合があるが、第1列（項目名）は固定表示（Sticky Column）が望ましい（実装難易度による、MVPでは全スクロールでも可）。

#### A. 基本情報
| 項目名 | データソース | 備考 |
|:---|:---|:---|
| **業界** | `industry` | |
| **証券コード** | `id` | |

#### B. 労働条件・環境 (Work Environment)
就活生が最も気にする「働きやすさ」と「待遇」の指標。

| 項目名 | データソース | ヒートマップ判定 (High is Good/Bad) | 備考 |
|:---|:---|:---|:---|
| **平均年収** | `metrics.salary` | **Good** | 万円単位 |
| **月間残業時間** | `metrics.overtime` | **Bad** (低いほど良い) | 時間単位。データなし時は「-」 |
| **有休取得率** | `metrics.paid_leave` | **Good** | %単位。データなし時は「-」 |
| **平均勤続年数** | `metrics.duration` | **Good** | 長いほど安定 |
| **平均年齢** | `metrics.age` | *Neutral* | 若手が多いかベテランが多いか |

#### C. 企業規模・財務 (Stability)
企業の安定性と成長性を示す指標。

| 項目名 | データソース | ヒートマップ判定 | 備考 |
|:---|:---|:---|:---|
| **売上高** | `metrics.revenue` | **Good** | 億円単位 |
| **営業利益率** | `metrics.profit_margin` | **Good** | 収益性の高さ |
| **自己資本比率** | `metrics.equity_ratio` | **Good** | 財務健全性（40%以上目安） |
| **従業員数** | `metrics.employees` | *Neutral* | 規模感 |

---

## 3. UI/UX 機能要件

### 3.1 ヒートマップ（条件付き書式）
比較している**表示中の企業内**で相対評価を行い、背景色をつける。

- **Best (1位)**: 薄い緑色 (`bg-green-100`) + 太字
- **Worst (最下位)**: 薄い赤色 (`bg-red-100`)
- **その他**: 背景色なし
- ※ データ欠損（null/undefined）がある場合は判定対象外とする。

### 3.2 空きスロットの扱い
比較企業が4社未満の場合でも、4列分のスペースを確保するか、あるいは「企業を追加」カラムを表示するか検討する。
**MVP方針**: カートに入っている企業数分だけカラムを表示する（最大4カラム）。空きスロット表示は不要。

### 3.3 アクション
- **一覧に戻る**: 画面左上に配置。「← 検索に戻る」
- **カートから削除**: ヘッダーの×ボタンで即時削除。0社になった場合は自動的に検索画面へリダイレクト。

---

## 4. ビジュアル比較機能 (Graphic View)
数値テーブルだけでなく、直感的に違いを把握できるグラフ表示を提供する。シンプルさを重視し、複雑な設定なしで閲覧可能にする。

### 4.1 レーダーチャート (総合バランス)
各企業の「強み・弱み」を多角的に可視化する。
- **指標 (5軸)**:
  1. **給与**: 年収
  2. **労働環境**: 残業時間の少なさ、有休取得率
  3. **安定性**: 勤続年数、自己資本比率
  4. **成長性**: 売上高、利益率
  5. **規模**: 従業員数
- **UI**: 選択中の企業を色分けして重ねて表示。

### 4.2 棒グラフ (単一指標比較)
特定の重要指標における差を明確にする。
- **表示項目**:
  - 平均年収比較
  - 残業時間比較
  - 有休取得率比較
- **UI**: 横棒グラフまたは縦棒グラフで、高い順/低い順が見てわかるようにする。

### 4.3 散布図 (XY相関 / Positioning Map)
2軸での位置付けを表示し、企業のキャラクターを分類する。
- **軸の例**:
  - X軸: **年収** (Low ↔ High)
  - Y軸: **残業時間** (Short ↔ Long)
    - → 右下（年収高＆残業少）が「ホワイト高給」ゾーン
- **UI**: 4象限のマトリクス上に企業ロゴをプロットする。

## 5. UI構成 (Layout)
- **タブ切り替え**: 「表で比較」「グラフで比較」のタブ、またはスクロールで「テーブル」→「グラフセクション」と続く構成。
  - **推奨**: スクロール構成（上部にテーブル、下部にグラフ）。詳細を見たいユーザーが下にスクロールする自然な流れ。

---

## 6. 将来拡張 (Out of Scope for MVP)
- **SOM（自己組織化マップ）**: 高度な計算とUI実装が必要なため、MVPでは対象外とする。フェーズ2以降で検討。
- **シェア機能**: 比較結果のURLをSNSでシェア。
- **ChatGPTによる要約比較**: 「A社は給与重視、B社はバランス型です」のようなテキスト生成。

